<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to Share a Secret (Diffie-Hellman-Merkle) | Polymath.cloud</title>

<meta name="keywords" content="Datastructures and Algorithms, Computer Science, InfoSec" />
<meta name="description" content="Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let&rsquo;s first look into what keys are and why we would want to invent a method to share keys without giving the other person the key.
 Your front door is usually locked by a key. This key unlocks &amp; locks your front door.">
<meta name="author" content="Bee">
<link rel="canonical" href="https://polymath.cloud/diffie-hellman-merkle/" />
<link href="https://polymath.cloud/assets/css/stylesheet.min.94a69f3d0b70cac76c6d6f7dfecc9f91f2319ec73d54be960b0d3624fa5a25e2.css" integrity="sha256-lKafPQtwysdsbW99/syfkfIxnsc9VL6WCw02JPpaJeI=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://polymath.cloud/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://polymath.cloud/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://polymath.cloud/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://polymath.cloud/apple-touch-icon.png">
<link rel="mask-icon" href="https://polymath.cloud/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.68.3" />




<style>
    td, th {
    border: thin solid #999 !important;
    padding: 12px 15px;
}

thead tr {
    background-color: #009879;
    color: #ffffff;
    text-align: left;
}

table {
    border-collapse: collapse;
    margin: 25px 0;
    font-size: 0.9em;
    font-family: sans-serif;
    min-width: 400px;
    overflow: auto;
    display: table;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
}

tbody tr {
    border-bottom: thin solid #dddddd;
}


tbody tr:last-of-type {
    border-bottom: 2px solid #009879;
}

tbody td.active-item {
    font-weight: bold;
    color: #009879;
}

tbody tr:nth-of-type(even) {
    background-color: #f3f3f3;
    }


body.dark tbody tr:nth-of-type(even) {
    background-color: #383838;
}


img {
    display: block;
    margin: auto;
    text-align: center;
}

</style>
<meta property="og:title" content="How to Share a Secret (Diffie-Hellman-Merkle)" />
<meta property="og:description" content="Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let&rsquo;s first look into what keys are and why we would want to invent a method to share keys without giving the other person the key.
 Your front door is usually locked by a key. This key unlocks &amp; locks your front door." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://polymath.cloud/diffie-hellman-merkle/" />
<meta property="article:published_time" content="2019-11-19T01:46:20+00:00" />
<meta property="article:modified_time" content="2019-11-19T01:46:20+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to Share a Secret (Diffie-Hellman-Merkle)"/>
<meta name="twitter:description" content="Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let&rsquo;s first look into what keys are and why we would want to invent a method to share keys without giving the other person the key.
 Your front door is usually locked by a key. This key unlocks &amp; locks your front door."/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to Share a Secret (Diffie-Hellman-Merkle)",
  "name": "How to Share a Secret (Diffie-Hellman-Merkle)",
  "description": "Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let\u0026amp;rsquo;s first look ‚Ä¶",
  "keywords": [
    "Datastructures and Algorithms", "Computer Science", "InfoSec"
  ],
  "articleBody": "Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let‚Äôs first look into what keys are and why we would want to invent a method to share keys without giving the other person the key.\n Your front door is usually locked by a key. This key unlocks \u0026 locks your front door. You have one key which you use to unlock and lock things.\nOnly people with the key or a copy of the key can unlock the door. Now, imagine you‚Äôre going to be on holiday Friday, Saturday, Sunday in Bali. You want to invite your friend around to look after your cat üò∫ while you‚Äôre on the beautiful beaches üèñÔ∏è.\nYour only friend is unfortunately on holiday Wednesday, Thursday and Friday. They get back right as you leave for holiday. You can‚Äôt be there to physically give them the key, but hiding the key under a rock outside your door seems insecure. Anyone could lift up that rock and find the key, but you just want your friend to have the key.\nThis is where Diffie-Hellman comes in. Well, with Diffie-Hellman you‚Äôre not exchanging physical keys but rather digital keys. Let‚Äôs explore some basic cryptography to understand why digital key exchange sucks just as much as real life key exchange.\n Julius Caesar used a cipher to send messages that no one else could read other than the intended recipient. Mainly because no one could read back in 100 BC, and those that could wouldn‚Äôt understand a random string of letters. That‚Äôs the whole point of cryptography. To create ways to communicate without third parties understanding the message. This cipher is Caesar*‚Äòs Cipher*. Given an alphabet and a key (the key is an integer between 1 and 25), shift all of the alphabet letters by key. Image from GeeksForGeeks showing Caeser‚Äôs Cipher shift of 3 With a shift of 3, as seen in the image above, A becomes D, B becomes E and so on until it wraps around with X = A. The original message is called the *plaintext *and the encrypted message is called the *ciphertext*.\nThe easiest way to perform Caesar‚Äôs Cipher is to turn all of the letters into numbers, a = 1, b = 2, c = 3 and so on.\nTo encrypt, E, you calculate this for every letter (where s is the shift):\n$$ E_{s}(letter) = (letter + shift)$$\nTo decrypt Caesar‚Äôs cipher, D, you calculate this for every letter:\n$$ D_{s}(letter) = (letter - shift)$$ Something important to note is that this version of the cipher doesn‚Äôt support wraparound (for brevity).\nAs you can tell, it‚Äôs not very secure. With 25 total shifts you just have to shift the text 25 times until you find the decrypted code, this is called a brute force attack. You take the encrypted text and shift it all 25 times until you find the decrypted text. But let‚Äôs imagine for a second that this was a hard cipher - that brute force isn‚Äôt feasible.\nThe shift is the key of Caesar‚Äôs cipher. But the problem still persists, how do you tell your friend you‚Äôre using a shift of 9? Any and all forms of communication can be listened in on. It doesn‚Äôt matter if you‚Äôre writing a letter or going to a hidden forest in Switzerland 30 miles from the nearest town. If you communicate the key, it can be listened in on.\nHow do you tell your friend you‚Äôre using a shift of 9, for example? You have to communicate it to them somehow. Any and all forms of communication can be listened in on - whether that‚Äôs writing a letter or going to a hidden forest in Switzerland 30 miles from the nearest town and telling your friend. The problem becomes even more apparent when you realise that communicating parties over the internet normally have no prior knowledge about each other and are thousands of miles apart. This is where the magic of Diffie-Hellman-Merkle key exchange comes in.\n Diffie-Hellman-Merkle Diffie-Hellman is a way to securely exchange keys in public. It was conceptualised by Ralph Merkle, and named After Whitfield Diffie and Martin Hellman. I have chosen to include Merkle‚Äôs name as the title because he put in just as much work as Diffie-Hellman and his name never appears when this algorithm is talked about.\nU.S. Patent 4,200,770, from 1977, is now expired and describes the now-public-domain algorithm. It credits Hellman, Diffie, and Merkle as inventors.\nLet‚Äôs go through how this algorithm works.\n Pick two numbers, G and N.  For this algorithm, we will also walk through the colour mixing method for explaining how it works.\nAlice and Bob publicly agree to use a modulus p = 23 and g = 5 (which is a primitive root modulo 23, explained later). Modulus is just the remainder of the division. Note: this example comes from Wikipedia.\nIt‚Äôs hard to describe the paint method in text, so if you want to know about this method I suggest watching this video: We‚Äôll colour G yellow. We have 2 copies of G (yellow) as seen above. When Alice and Bob agree on these numbers, Eve knows they are using these numbers.\nAlice needs to calculate a private key.  She does this by picking a secret number (a). She computes $G^a ; mod ; p$ and sends that result to Bob.\nAlice chooses a secret, random integer a = 4.\nAlice computes $A = 5^4 ; mod ; 23 = 4$ and sends the number 4 to Bob.\nShe colours this private key reddish-brown. Eve doesn‚Äôt know Alice‚Äôs secret number is 4, only that the result of this equation is 4. It‚Äôs not feasible for Eve to calculate what Alice‚Äôs secret number is from the resultant of this equation.\nBob makes his own private key. Its colour is dark green.  He calculates this by picking a secret number (b) and computing $g^b ; mod ; p$. He then sends the result to Alice. Bob creates a random private key, for this example we‚Äôll use 3.\nThen Bob calculates $B = 5^3 ; mod ; 23 = 10$ and sends 10 to Alice. 4. Now Bob takes the number Alice sent him and computes $b^a ; mod ; p$.\nIn the colour analogy, this is taking Alice‚Äôs paint colour and adding it to Bob‚Äôs paint colour.\nBob computes $s = 4^3 ; mod ; 23 = 18$ Bob doesn‚Äôt send this to Alice.\nAlice computes $A^b ; mod ; p$.  In the paint analogy, this is Alice adding Bob‚Äôs paint (that Bob sent her) to her paint.\nAlice calculates $s = 10^4 ; mod ; 23 = 18$\nThe magic is that Alice and Bob now have the same number, or the same paint colour. Let‚Äôs discuss in detail the mathematics behind this cool algorithm.\n Explanation of maths Diffie-Hellman-Merkle works because of a cool modulus exponent principle. First, let‚Äôs explain what modulus is before we try to understand this principle.\nModular Arithmetic Imagine a finite range of numbers, for example, 1 to 12. These numbers are arranged in a circle, much like a clock (modular arithmetic is sometimes called clock arithmetic because of this). https://commons.wikimedia.org Count 13 around this clock. You get to 12 and then you need to count 1 more - so you go back to 1. Modular arithmetic is still defined as the remainder of division, however it can also be defined (and is more commonly defined) as a clock.\nFunctions using modular arithmetic tend to perform erratically, which in turn sometimes makes them one-way functions. Let‚Äôs see this with an example by taking a regular function and seeing how it works when it becomes a modular arithmetic function.\n$$3^x$$\nWhen we insert 2 into this function, we get $3^2 = 6$. Insert 3 and we get $3^3 = 9$.\nThis function is easy to reverse. If we‚Äôre given 9, we can tell that the function had an input of 3, because of $3^3 = 9$.\nHowever, with modular arithmetic added, it doesn‚Äôt behave sensibly.\nImage we had this formula:\n$$ 3^x ; mod ; 7 = 1$$\nHow would you find out what x is? You can‚Äôt put the mod on the other side, because there isn‚Äôt really an inverse of modular arithmetic. What about guessing? Let‚Äôs input 5:\n$$ 3^5 ; mod ; 7 = 5$$\nOkay, that was too big. You might want to go lower, maybe 4 or 3 but actually this is the wrong direction. When x is 6, it is equal to 1.\nIn normal arithmetic, we can test numbers and get a feel for whether we are getting warmer or colder, but this isn‚Äôt the case with modular arithmetic.\nOften the easiest way to reverse modular arithmetic is to compile a table for all values of x until the right answer is found. Although this may work for smaller numbers, it is computationally infeasible to do for much larger numbers. This is often why modular arithmetic is known as a one-way function.\nIf I gave you a number such as 5787 and told you to find the function for it, it would be infeasible. In fact, if I gave you the ability to input any number into the function it would still be hard. It took me a mere few seconds to make this function, but it‚Äôll take you hours or maybe even days to work out what x is.\nDiffie-Hellman-Merkle is a one-way function. While it is relatively easy to carry out this function, it is computationally infeasible to do the reverse of the function and find out what the keys are. Although, it is possible to reverse an RSA encryption if you know some numbers such as N.\nPrimitive root The primitive root of a prime number, p, is a number, a, such that all numbers:\n$$a ; mod ; p, a^2 mod p, a^3 ; mod ; p, a^4 ; mod ; p, ‚Ä¶$$\nare different. There is a formula for counting what the indices are, but I think it‚Äôs far more intuitive to think ‚Äúthe second one is to the power of 2, the third one is to the power of 3‚Äù and so on.\nLet‚Äôs see an example where $p = 7$. Let‚Äôs set $a_1 = 2$ and $a_2 = 3$.\n$$2^0 = 1 ( mod ; 7) = 1$$\n$$2^1 = 2 ( mod ; 7) = 2$$\n$$2^2 = 4 ( mod ; 7) = 4$$\n$$2^3 = 8 ( mod ; 7) = 1$$\nUh oh! 20 is the same as 23. This means that 2 is not a primitive root of 7. Let‚Äôs try again with 3.\n$$3^0 = 1 ( mod ; 7) = 1$$\n$$3^1 = 3 (mod ; 7) = 3$$\n$$3^2 = 9 (mod ; 7) = 2$$\n$$3^3 = 27 (mod ; 7) = 6$$\n$$3^4 = 81 ( mod ; 7) = 4$$\n$$3^5 = 243 ( mod ; 7) = 5$$\n$$3^6 = 1 (mod ; 7) = 1$$\nNow let‚Äôs try a = 3.\n$$3^0 = 1$$\n$$3^1 = 3$$\n$$3^2 = 2$$\n$$3^3 = 6$$\n$$3^4 = 4$$\n$$3^5 = 5$$\n$$3^6 = 1$$\nNow we‚Äôve gotten a cycle in these powers.\n36 = 1, and 30 = 1. This is because we are using modulus it repeats into this cycle, so we can stop now. Unlike before where we reached 23 and it cycled, it‚Äôs okay if it cycles here because for any prime number, p, and any number, a, such that $a \\ne 0 ; mod ; p$ and $a \\ne 1 ; mod ; p$ the consecutive powers of $a$ may cover no more than p - 1 values modulo p. That is, we go from $1, ‚Ä¶, p - 1$. When p is 7, the consecutive powers cover up to 6.\nDiscrete logarithms $$a^b = c ; mod ; n$$\nSuch an equation means some numbers you can write it differently as:\n$$log_a c = b ; mod ; n$$\nLogarithms are the inverse of exponents, we‚Äôve just inversed the sum here.\nNow it‚Äôs a well defined function, we can say in discrete terms that $log_3 5 = 5 ; (mod ; 7)$ (looking at the table above).\nif you use a non-primitive root number it becomes easier, as we have a smaller number of outcomes (because it repeats earlier), as seen below.\n$$2^0 = 1 (mod ; 7) = 1$$\n$$2^1 = 2 ( mod ; 7) = 2$$\n$$2^2 = 4 ( mod ; 7) = 4$$\n$$2^3 = 8 ( mod ; 7) = 1$$\nBy using a primitive root, we get a much larger outcome which makes it harder.\n$$3^0 = 1 ( mod ; 7) = 1$$\n$$3^1 = 3 (mod ; 7) = 3$$\n$$3^2 = 9 ( mod ; 7) = 2$$\n$$3^3 = 27 ( mod ; 7) = 6$$\n$$3^4 = 81 ( mod ; 7) = 4$$\n$$3^5 = 243 ( mod ; 7) = 5$$\n$$3^7 = 1 ( mod ; 7) = 1$$\nIt is relatively easy to calculate exponentials modulo a prime, that is a, I, p calculate $a^i mod p$.\nExponentiation is a cheap operation. you can do it even for very large numbers while logarithm is a much more difficult function to calculate for large numbers.\nTo calculate exponentiation, you give number 2 and you respond to me what the answer is. that‚Äôs exponentiation, going from left to right.\n$$3^0 = 1$$\n$$3^1 = 3$$\n$$3^2 = 2$$\n$$3^3 = 6$$\n$$3^4 = 4$$\n$$3^5 = 5$$\nLogarithm is how to go back, from right to left. Logarithms are much harder than exponentiation.\n Maths implemented Let‚Äôs go back to seeing how Diffie-Hellman worked, but this time with a lot more knowledge of how the mathematics works.\nWe have 2 people, Alice and Bob. Each of them has to agree in advance some prime number q (publicly known number) and its primitive root $\\alpha$(publicly known).\nWe randomly select the prime number 7 with the primitive root 3.\nLet Alice and Bob wish to exchange a key, then they do the following:\n Alice selects a random integer $x_a B selects a random integer $x_b Alice calculates the function left to right (exponentiation)  $$3^0 = 2$$\n$$3^1 = 3$$\n$$3^2 = 2$$\n$$3^3 = 6$$\n$$3^4 = 4$$\n$$3^5 = 5$$\nand they choose one of the exponents, chosen randomly and kept in a secret. Now Alice does $y_a = a^{x a} mod q$ and sends it to Bob.\nThis example isn‚Äôt very impressive, and sometimes $3^5 = 5$ but for much larger numbers most things change everything, this is almost RSA encryption (the idea is the same, but it‚Äôs not quite the same as this is key exchange, not encryption)\nBob then does the same as Alice. Both Alice and Bob are now capable of calculating the shared key.\nAlice calculates $k = (y_b)^{x_a} ; mod ; q$\nBob calculates $k = (y_a)^{x_b} ; mod ; q$\nNow they have the same numbers, k is the common secret key.\n$$(\\alpha ^ {x_b})^{x_a} = (\\alpha ^ {x_a})^{x_b}$$\nThis equation above is what makes it all work. The formulae are the same, but different. You get Alice to do one side of the formula, Bob does another side and they end up with the same number.\nThis really is the equation that puts it all together. Most of this blog post led up to this equation.\na and b are secret, and without these numbers, there is no easy way to repeat these computations because in to do it you need to know the secrets.\nThe above formula shows that the two methods are exactly equal. If you do the left equation, you get the same result as the right equation.\n Conclusion Diffie-Hellman-Merkle is a fascinating way of sharing a secret over an unsecured communications medium, by not sharing it at all over that medium.\nIf you want to learn about the different attacks that have been attempted on Diffie-Hellman and one attack which might be a very big problem, sign up to my email list below and I‚Äôll send you the PDF üòÅ‚ú®\n If you‚Äôre feeling extra generous, I have a PayPal  and even a Patreon. I‚Äôm a university student who writes these articles in my spare time. This blog is my full time job, so any and all donations are appreciated\n",
  "wordCount" : "2768",
  "inLanguage": "en",
  "datePublished": "2019-11-19T01:46:20Z",
  "dateModified": "2019-11-19T01:46:20Z",
  "author":{
    "@type": "Person",
    "name": "Bee"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://polymath.cloud/diffie-hellman-merkle/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Polymath.cloud",
    "logo": {
      "@type": "ImageObject",
      "url": "https://polymath.cloud/favicon.ico"
    }
  }
}
</script>



</head>

<body class="">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://polymath.cloud" accesskey="h">Polymath.cloud</a>
            <span class="logo-switches">
                <span class="theme-toggle">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://polymath.cloud/archives" title="Archive">
                    <span>
                        Archive
                    </span>
                </a>
            </li>
            <li>
                <a href="https://polymath.cloud/search/" title="Search">
                    <span>
                        Search
                    </span>
                </a>
            </li>
            <li>
                <a href="https://polymath.cloud/tags/" title="Tags">
                    <span>
                        Tags
                    </span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      How to Share a Secret (Diffie-Hellman-Merkle)
    </h1>
    <div class="post-meta">

November 19, 2019&nbsp;¬∑&nbsp;13 min&nbsp;¬∑&nbsp;Bee

    </div>
  </header> 

  <div class="post-content">
<p>Diffie-Hellman-Merkle is a way to share a secret key with someone (or something) without actually sending them the key. Before we look into how we share keys let&rsquo;s first look into what keys are and why we would want to invent a method to share keys without giving the other person the key.</p>
<hr>
<p>Your front door is usually locked by a key. This key unlocks &amp; locks your front door. You have one key which you use to unlock and lock things.</p>
<p>Only people with the key or a copy of the key can unlock the door. Now, imagine you&rsquo;re going to be on holiday Friday, Saturday, Sunday in Bali. You want to invite your friend around to look after your cat üò∫ while you&rsquo;re on the beautiful beaches üèñÔ∏è.</p>
<p>Your only friend is unfortunately on holiday Wednesday, Thursday and Friday. They get back right as you leave for holiday. You can&rsquo;t be there to physically give them the key, but hiding the key under a rock outside your door seems insecure. Anyone could lift up that rock and find the key, but you just want your friend to have the key.</p>
<p>This is where Diffie-Hellman comes in. Well, with Diffie-Hellman you&rsquo;re not exchanging physical keys but rather digital keys. Let&rsquo;s explore some basic cryptography to understand why digital key exchange sucks just as much as real life key exchange.</p>
<hr>
<p>Julius Caesar used a cipher to send messages that no one else could read other than the intended recipient. Mainly because no one could read back in 100 BC, and those that could wouldn&rsquo;t understand a random string of letters. That&rsquo;s the whole point of cryptography. To create ways to communicate without third parties understanding the message. This cipher is Caesar*&lsquo;s Cipher*. Given an alphabet and a key (the key is an integer between 1 and 25), shift all of the alphabet letters by key.
<img src="/content/images/2019/01/image.png" alt="">Image from <a href="https://www.geeksforgeeks.org/caesar-cipher/">GeeksForGeeks</a> showing Caeser&rsquo;s Cipher shift of 3
With a shift of 3, as seen in the image above, A becomes D, B becomes E and so on until it wraps around with X = A. The original message is called the *plaintext *and the encrypted message is called the *ciphertext*.</p>
<p>The easiest way to perform Caesar&rsquo;s Cipher is to turn all of the letters into numbers, a = 1, b = 2, c = 3 and so on.</p>
<p>To encrypt, E, you calculate this for every letter (where s is the shift):</p>
<p>$$ E_{s}(letter) = (letter + shift)$$</p>
<p>To decrypt Caesar&rsquo;s cipher, D, you calculate this for every letter:</p>
<p>$$ D_{s}(letter) = (letter - shift)$$ ¬†</p>
<p>Something important to note is that this version of the cipher doesn&rsquo;t support ¬†wraparound (for brevity).</p>
<p>As you can tell, it&rsquo;s not very secure. With 25 total shifts you just have to shift the text 25 times until you find the decrypted code, this is called a brute force attack. You take the encrypted text and shift it all 25 times until you find the decrypted text. But let&rsquo;s imagine for a second that this was a hard cipher - that brute force isn&rsquo;t feasible.</p>
<p>The shift is the key of Caesar&rsquo;s cipher. But the problem still persists, how do you tell your friend you&rsquo;re using a shift of 9? Any and all forms of communication can be listened in on. It doesn&rsquo;t matter if you&rsquo;re writing a letter or going to a hidden forest in Switzerland 30 miles from the nearest town. If you communicate the key, it can be listened in on.</p>
<p>How do you tell your friend you&rsquo;re using a shift of 9, for example? You have to communicate it to them somehow. Any and all forms of communication can be listened in on - whether that&rsquo;s writing a letter or going to a hidden forest in Switzerland 30 miles from the nearest town and telling your friend.
<img src="/content/images/2019/02/Blank-Diagram-1.png" alt="">
The problem becomes even more apparent when you realise that communicating parties over the internet normally have no prior knowledge about each other and are thousands of miles apart. This is where the magic of Diffie-Hellman-Merkle key exchange comes in.</p>
<hr>
<h2 id="diffie-hellman-merkle">Diffie-Hellman-Merkle<a hidden class="anchor" aria-hidden="true" href="#diffie-hellman-merkle">#</a></h2>
<p>Diffie-Hellman is a way to securely exchange keys in public. It was conceptualised ¬†by Ralph Merkle, and named After Whitfield Diffie and Martin Hellman. I have chosen to include Merkle&rsquo;s name as the title because he put in just as much work as Diffie-Hellman and his name never appears when this algorithm is talked about.</p>
<p><a href="https://www.google.com/patents/US4200770">U.S. Patent 4,200,770</a>, from 1977, is now expired and describes the now-public-domain algorithm. It credits Hellman, Diffie, and Merkle as inventors.</p>
<p>Let&rsquo;s go through how this algorithm works.</p>
<ol>
<li>Pick two numbers, G and N.</li>
</ol>
<p>For this algorithm, we will also walk through the colour mixing method for explaining how it works.</p>
<p>Alice and Bob publicly agree to use a modulus p = 23 and g = 5 (which is a primitive root modulo 23, explained later). Modulus is just the remainder of the division. Note: this example comes from <a href="https://www.wikiwand.com/en/Diffie%E2%80%93Hellman_key_exchange">Wikipedia</a>.</p>
<p>It&rsquo;s hard to describe the paint method in text, so if you want to know about this method I suggest watching this video:
<img src="/content/images/2019/02/image-114.png" alt="">
We&rsquo;ll colour G yellow. We have 2 copies of G (yellow) as seen above.
<img src="/content/images/2019/02/Blank-Diagram-8-.png" alt="">
When Alice and Bob agree on these numbers, Eve knows they are using these numbers.</p>
<ol start="2">
<li>Alice needs to calculate a private key.</li>
</ol>
<p>She does this by picking a secret number (a). She computes $G^a ; mod ; p$ and sends that result to Bob.</p>
<p>Alice chooses a secret, random integer a = 4.</p>
<p>Alice computes $A = 5^4 ; mod ; 23 = 4$ and sends the number 4 to Bob.</p>
<p>She colours this private key reddish-brown.
<img src="/content/images/2019/02/Blank-Diagram-9-.png" alt="">
Eve doesn&rsquo;t know Alice&rsquo;s secret number is 4, only that the result of this equation is 4. It&rsquo;s not feasible for Eve to calculate what Alice&rsquo;s secret number is from the resultant of this equation.</p>
<ol start="3">
<li>Bob makes his own private key. Its colour is dark green.</li>
</ol>
<p>He calculates this by picking a secret number (b) and computing $g^b ; mod ; p$. He then sends the result to Alice. Bob creates a random private key, for this example we&rsquo;ll use 3.</p>
<p>Then Bob calculates $B = 5^3 ; mod ; 23 = 10$ and sends 10 to Alice.
<img src="/content/images/2019/02/Blank-Diagram-37-.png" alt="">
4. Now Bob takes the number Alice sent him and computes $b^a ; mod ; p$.</p>
<p>In the colour analogy, this is taking Alice&rsquo;s paint colour and adding it to Bob&rsquo;s paint colour.</p>
<p>Bob computes $s = 4^3 ; mod ; 23 ¬†= 18$
<img src="/content/images/2019/02/Blank-Diagram-38-.png" alt="">
Bob doesn&rsquo;t send this to Alice.</p>
<ol start="5">
<li>Alice computes $A^b ; mod ; p$.</li>
</ol>
<p>In the paint analogy, this is Alice adding Bob&rsquo;s paint (that Bob sent her) to her paint.</p>
<p>Alice calculates $s = 10^4 ; mod ; 23 = 18$</p>
<p>The magic is that Alice and Bob now have the same number, or the same paint colour.
<img src="/content/images/2019/02/Blank-Diagram-39-.png" alt="">
Let&rsquo;s discuss in detail the mathematics behind this cool algorithm.</p>
<hr>
<h2 id="explanation-of-maths">Explanation of maths<a hidden class="anchor" aria-hidden="true" href="#explanation-of-maths">#</a></h2>
<p>Diffie-Hellman-Merkle works because of a cool modulus exponent principle. First, let&rsquo;s explain what modulus is before we try to understand this principle.</p>
<h3 id="modular-arithmetic">Modular Arithmetic<a hidden class="anchor" aria-hidden="true" href="#modular-arithmetic">#</a></h3>
<p>Imagine a finite range of numbers, for example, 1 to 12. These numbers are arranged in a circle, much like a clock (modular arithmetic is sometimes called clock arithmetic because of this).
<img src="/content/images/2019/01/image-507.png" alt=""><a href="https://commons.wikimedia.org">https://commons.wikimedia.org</a>
Count 13 around this clock. You get to 12 and then you need to count 1 more - so you go back to 1. Modular arithmetic is still defined as the remainder of division, however it can also be defined (and is more commonly defined) as a clock.</p>
<p>Functions using modular arithmetic tend to perform erratically, which in turn sometimes makes them one-way functions. Let&rsquo;s see this with an example by taking a regular function and seeing how it works when it becomes a modular arithmetic function.</p>
<p>$$3^x$$</p>
<p>When we insert 2 into this function, we get $3^2 = 6$. Insert 3 and we get $3^3 = 9$.</p>
<p>This function is easy to reverse. If we&rsquo;re given 9, we can tell that the function had an input of 3, because of $3^3 = 9$.</p>
<p>However, with modular arithmetic added, it doesn&rsquo;t behave sensibly.</p>
<p>Image we had this formula:</p>
<p>$$ 3^x ; mod ; 7 = 1$$</p>
<p>How would you find out what x is? You can&rsquo;t put the mod on the other side, because there isn&rsquo;t really an inverse of modular arithmetic. What about guessing? Let&rsquo;s input 5:</p>
<p>$$ 3^5 ; mod ; 7 = 5$$</p>
<p>Okay, that was too big. You might want to go lower, maybe 4 or 3 but actually this is the wrong direction. When x is 6, it is equal to 1.</p>
<p>In normal arithmetic, we can test numbers and get a feel for whether we are getting warmer or colder, but this isn&rsquo;t the case with modular arithmetic.</p>
<p>Often the easiest way to reverse modular arithmetic is to compile a table for all values of x until the right answer is found. Although this may work for smaller numbers, it is computationally infeasible to do for much larger numbers. This is often why modular arithmetic is known as a one-way function.</p>
<p>If I gave you a number such as 5787 and told you to find the function for it, it would be infeasible. In fact, if I gave you the ability to input any number into the function it would still be hard. It took me a mere few seconds to make this function, but it&rsquo;ll take you hours or maybe even days to work out what x is.</p>
<p>Diffie-Hellman-Merkle is a one-way function. While it is relatively easy to carry out this function, it is computationally infeasible to do the reverse of the function and find out what the keys are. Although, it is possible to reverse an RSA encryption if you know some numbers such as N.</p>
<h3 id="primitive-root">Primitive root<a hidden class="anchor" aria-hidden="true" href="#primitive-root">#</a></h3>
<p>The primitive root of a prime number, p, is a number, a, such that all numbers:</p>
<p>$$a ; mod ; p, a^2 mod p, a^3 ; mod ; p, a^4 ; mod ; p, &hellip;$$</p>
<p>are different. There is a formula for counting what the indices are, but I think it&rsquo;s far more intuitive to think &ldquo;the second one is to the power of 2, the third one is to the power of 3&rdquo; and so on.</p>
<p>Let&rsquo;s see an example where $p = 7$. Let&rsquo;s set $a_1 = 2$ and $a_2 = 3$.</p>
<p>$$2^0 = 1 ( mod ; 7) = 1$$</p>
<p>$$2^1 = 2 ( mod ; 7) = 2$$</p>
<p>$$2^2 = 4 ( mod ; 7) = 4$$</p>
<p>$$2^3 = 8 ( mod ; 7) = 1$$</p>
<p>Uh oh! 20 is the same as 23. This means that 2 is not a primitive root of 7. Let&rsquo;s try again with 3.</p>
<p>$$3^0 = 1 ( mod ; 7) = 1$$</p>
<p>$$3^1 = 3 (mod ; 7) = 3$$</p>
<p>$$3^2 = 9 (mod ; 7) = 2$$</p>
<p>$$3^3 = 27 (mod ; 7) = 6$$</p>
<p>$$3^4 = 81 ( mod ; 7) = 4$$</p>
<p>$$3^5 = 243 ( mod ; 7) = 5$$</p>
<p>$$3^6 = 1 (mod ; 7) = 1$$</p>
<p>Now let&rsquo;s try a = 3.</p>
<p>$$3^0 = 1$$</p>
<p>$$3^1 = 3$$</p>
<p>$$3^2 = 2$$</p>
<p>$$3^3 = 6$$</p>
<p>$$3^4 = 4$$</p>
<p>$$3^5 = 5$$</p>
<p>$$3^6 = 1$$</p>
<p>Now we&rsquo;ve gotten a cycle in these powers.</p>
<p>36 = 1, and 30 = 1. This is because we are using modulus it repeats into this cycle, so we can stop now. Unlike before where we reached 23 and it cycled, it&rsquo;s okay if it cycles here because for any prime number, p, and any number, a, such that $a \ne 0 ; mod ; p$ and $a \ne 1 ; mod ; p$ the consecutive powers of $a$ may cover no more than p - 1 values modulo p. That is, we go from $1, &hellip;, p - 1$. When p is 7, the consecutive powers cover up to 6.</p>
<h3 id="discrete-logarithms">Discrete logarithms<a hidden class="anchor" aria-hidden="true" href="#discrete-logarithms">#</a></h3>
<p>$$a^b = c ; mod ; n$$</p>
<p>Such an equation means some numbers you can write it differently as:</p>
<p>$$log_a c = b ; mod ; n$$</p>
<p>Logarithms are the inverse of exponents, we&rsquo;ve just inversed the sum here.</p>
<p>Now it&rsquo;s a well defined function, we can say in discrete terms that $log_3 5 = 5 ; (mod ; 7)$ (looking at the table above).</p>
<p>if you use a non-primitive root number it becomes easier, as we have a smaller number of outcomes (because it repeats earlier), as seen below.</p>
<p>$$2^0 = 1 (mod ; 7) = 1$$</p>
<p>$$2^1 = 2 ( mod ; 7) = 2$$</p>
<p>$$2^2 = 4 ( mod ; 7) = 4$$</p>
<p>$$2^3 = 8 ( mod ; 7) = 1$$</p>
<p>By using a primitive root, we get a much larger outcome which makes it harder.</p>
<p>$$3^0 = 1 ( mod ; 7) = 1$$</p>
<p>$$3^1 = 3 (mod ; 7) = 3$$</p>
<p>$$3^2 = 9 ( mod ; 7) = 2$$</p>
<p>$$3^3 = 27 ( mod ; 7) = 6$$</p>
<p>$$3^4 = 81 ( mod ; 7) = 4$$</p>
<p>$$3^5 = 243 ( mod ; 7) = 5$$</p>
<p>$$3^7 = 1 ( mod ; 7) = 1$$</p>
<p>It is relatively easy to calculate exponentials modulo a prime, that is a, I, p calculate $a^i mod p$.</p>
<p>Exponentiation is a cheap operation. you can do it even for very large numbers while logarithm is a much more difficult function to calculate for large numbers.</p>
<p>To calculate exponentiation, you give number 2 and you respond to me what the answer is. that&rsquo;s exponentiation, going from left to right.</p>
<p>$$3^0 = 1$$</p>
<p>$$3^1 = 3$$</p>
<p>$$3^2 = 2$$</p>
<p>$$3^3 = 6$$</p>
<p>$$3^4 = 4$$</p>
<p>$$3^5 = 5$$</p>
<p>Logarithm is how to go back, from right to left. Logarithms are much harder than exponentiation.</p>
<hr>
<h2 id="maths-implemented">Maths implemented<a hidden class="anchor" aria-hidden="true" href="#maths-implemented">#</a></h2>
<p>Let&rsquo;s go back to seeing how Diffie-Hellman worked, but this time with a lot more knowledge of how the mathematics works.</p>
<p>We have 2 people, Alice and Bob. Each of them has to agree in advance some prime number q (publicly known number) and its primitive root $\alpha$(publicly ¬†known).</p>
<p>We randomly select the prime number 7 with the primitive root 3.</p>
<p>Let Alice and Bob wish to exchange a key, then they do the following:</p>
<ol>
<li>Alice selects a random integer $x_a &lt; q$ and keeps it in secret</li>
<li>B selects a random integer $x_b &lt; q$ and keeps it in secret</li>
<li>Alice calculates the function left to right (exponentiation)</li>
</ol>
<p>$$3^0 = 2$$</p>
<p>$$3^1 = 3$$</p>
<p>$$3^2 = 2$$</p>
<p>$$3^3 = 6$$</p>
<p>$$3^4 = 4$$</p>
<p>$$3^5 = 5$$</p>
<p>and they choose one of the exponents, chosen randomly and kept in a secret. Now Alice does $y_a = a^{x a} mod q$ and sends it to Bob.</p>
<p>This example isn&rsquo;t very impressive, and sometimes $3^5 = 5$ but for much larger numbers most things change everything, this is almost RSA encryption (the idea is the same, but it&rsquo;s not quite the same as this is key exchange, not encryption)</p>
<p>Bob then does the same as Alice. Both Alice and Bob are now capable of calculating the shared key.</p>
<p>Alice calculates $k = (y_b)^{x_a} ; mod ; q$</p>
<p>Bob calculates $k = (y_a)^{x_b} ; mod ; q$</p>
<p>Now they have the same numbers, k is the common secret key.</p>
<p>$$(\alpha ^ {x_b})^{x_a} = (\alpha ^ {x_a})^{x_b}$$</p>
<p>This equation above is what makes it all work. The formulae are the same, but different. You get Alice to do one side of the formula, Bob does another side and they end up with the same number.</p>
<p>This really is the equation that puts it all together. Most of this blog post led up to this equation.</p>
<p>a and b are secret, and without these numbers, there is no easy way to repeat these computations because in to do it you need to know the secrets.</p>
<p>The above formula shows that the two methods are exactly equal. If you do the left equation, you get the same result as the right equation.</p>
<hr>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Diffie-Hellman-Merkle is a fascinating way of sharing a secret over an unsecured communications medium, by not sharing it at all over that medium.</p>
<p>If you want to learn about the different attacks that have been attempted on Diffie-Hellman and one attack which might be a very big problem, sign up to my email list below and I&rsquo;ll send you the PDF üòÅ‚ú®</p>
<hr>
<p>If you&rsquo;re feeling extra generous, I have a <a href="https://www.paypal.me/BrandonSkerritt">PayPal </a> and even a <a href="https://www.patreon.com/user?u=15993188">Patreon</a>. I&rsquo;m a university student who writes these articles in my spare time. This blog is my full time job, so any and all donations are appreciated</p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://polymath.cloud/tags/computer-science/">Computer Science</a></li>
      <li><a href="https://polymath.cloud/tags/datastructures-and-algorithms/">Datastructures and Algorithms</a></li>
      <li><a href="https://polymath.cloud/tags/infosec/">Infosec</a></li>
    </ul>






<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on twitter"
        href="https://twitter.com/intent/tweet/?text=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29&amp;url=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f&amp;hashtags=DatastructuresandAlgorithms%2cComputerScience%2cInfoSec">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f&amp;title=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29&amp;summary=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29&amp;source=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f&title=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on whatsapp"
        href="https://api.whatsapp.com/send?text=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29%20-%20https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How to Share a Secret (Diffie-Hellman-Merkle) on telegram"
        href="https://telegram.me/share/url?text=How%20to%20Share%20a%20Secret%20%28Diffie-Hellman-Merkle%29&amp;url=https%3a%2f%2fpolymath.cloud%2fdiffie-hellman-merkle%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://polymath.cloud">Polymath.cloud</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<button class="top-link" id="top-link" type="button" aria-label="go to top" title="Go to Top" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
        <path d="M12 6H0l6-6z" /></svg>
</button>



<script defer src="https://polymath.cloud/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
    mybutton.onclick = function () {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        window.location.hash = ''
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
